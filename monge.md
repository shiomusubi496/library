行列 $A$ が monotone であるとは、 $\arg\min A_i \leq \arg\min A_{i+1}$ を満たすこと。各行の最小値を $O(N + M \log N)$ 個の要素を見るだけで求められる。いわゆる monotone minima。

行列 $A$ が totally monotone であるとは、 $A$ の任意の部分行列 (任意の列、行を削除した行列) が monotone であること。 totally monotone な行列は monotone である。

同値な定義として、任意の $1 \leq i < i+1 \leq N,  1 \leq j < k \leq M$ に対して $\begin{pmatrix} A_{i, j} & A_{i, k} \\ A_{i+1, j} & A_{i+1, k} \end{pmatrix}$ が monotone である、つまり $A_{i, j} > A_{i, k}$ ならば $A_{i+1, j} > A_{i+1, k}$ であること、がある。

このとき、 SMAWK アルゴリズムを用いることで $O(N+M)$ 個で抑えられる。

行列 $A$ が Monge であるとは、任意の $1 \leq i < j \leq N, 1 \leq k < l \leq M$ に対して $A_{i, k} + A_{j, l} \leq A_{i, l} + A_{j, k}$ を満たすこと。お気持ちとしてはバランス良くした方が小さくなる、という感じ。Monge ならば totally monotone なので、 SMAWK アルゴリズムが使える。

また、頂点 $i$ から頂点 $j$ への距離が $A_{i, j}$ $(i < j)$ であり、 $A$ が Monge であるような場合、頂点 $1$ から頂点 $N$ への $d$ 辺最短距離を $f(d)$ とすると $f$ は下に凸であるため、 Alien DP が使える。

Alien DP とは、下に凸な関数 $f:\mathbb{Z}\to\mathbb{Z}$ で、 $g(p)=\min_x f(x)-px$ を高速に求められる場合に $f(x)$ を高速に求められるテクニック。 $1$ 辺のコストを $p$ 小さくすれば上の問題で適用できる。

- $g$ は上に凸な関数なので、 $g(p)$ で最小値を取る $x$ の最小値/最大値を効率的に求められる場合にこれを用いて二分探索できる。

- $g(p)$ で min を取る $x$ の最小値は $g(p-1)$ でも最小値を取るため、 $g(p)-g(p-1)$ によってそれを求められる。これは $p$ に対し単調増加なのでこれを用いて二分探索をする。

- $g(p)+pd=\min_x f(x)-p(x-d)$ を考えると、これも上に凸で、しかも最大値において min を取る $x$ は $d$ であるため、最大化する(三分探索や黄金分割探索など)。ここで傾き二分探索を使うと、実質的に上の二分探索と同じになる。
